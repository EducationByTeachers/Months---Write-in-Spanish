<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Months - Type in Spanish</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --good:#16a34a;
      --good-bg:#d1fae5;
      --bad:#ef4444;
      --bad-bg:#fee2e2;
      --border:#cbd5e1;
      --card:#ffffff;
      --bg:#f5f7fb;
      --text:#111827;
      --muted:#6b7280;
      --primary:#0d6efd;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color:var(--text); background:var(--bg);
      min-height:100vh; display:flex; align-items:center; justify-content:center;
    }
    .screen{display:none; width:min(900px,94vw)}
    #startScreen{display:block}
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:18px;
      box-shadow:0 10px 30px rgba(0,0,0,.06);
      padding:28px;
    }
    h1{margin:0 0 8px; font-size:clamp(24px,4vw,36px)}
    p{margin:8px 0 16px; color:var(--muted)}
    .btn{
      display:inline-block; border:0; background:var(--primary); color:#fff;
      padding:10px 18px; border-radius:10px; font-size:16px; cursor:pointer;
    }
    .layout{
      display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-top:18px;
    }
    .column{
      display:grid; grid-template-rows: repeat(12, auto); gap:8px;
    }
    .en-cell{
      background:#fff; border:1px solid var(--border); border-radius:10px;
      padding:8px; text-align:center; font-weight:700; min-height:40px; display:flex; align-items:center; justify-content:center;
    }
    .input-wrap{
      display:flex; flex-direction:column; align-items:stretch;
    }
    .input-cell{
      height:40px; border:1.5px solid var(--border); border-radius:10px; text-align:center; font-weight:700;
      font-size:15px; outline:none;
    }
    .input-cell.correct{
      background:var(--good-bg); border-color:var(--good); color:#065f46;
    }
    .input-cell.incorrect{
      background:var(--bad-bg); border-color:var(--bad); color:#7f1d1d;
      animation: shake .15s linear 1;
    }
    @keyframes shake{
      0%{transform:translateX(0)}25%{transform:translateX(-5px)}
      50%{transform:translateX(5px)}75%{transform:translateX(-3px)}100%{transform:translateX(0)}
    }
    .error-msg{
      display:none; margin-top:4px; font-size:12px; color:#b91c1c; text-align:center;
    }
    .error-msg.show{display:block}
    #goodJob{
      display:none; position:fixed; inset:0; z-index:30; pointer-events:none;
      align-items:center; justify-content:center; font-weight:900; color:#10b981;
      text-shadow:0 6px 24px rgba(16,185,129,.45); font-size:min(18vw,140px);
    }
    #confetti{position:fixed; inset:0; pointer-events:none; z-index:25;}
    .toolbar{margin-top:16px; text-align:center}
  </style>
</head>
<body>
  <!-- Start screen -->
  <section id="startScreen" class="screen">
    <div class="card">
      <h1>Months - Type in Spanish</h1>
      <p>Type the Spanish name for each English month. If it’s wrong, you’ll see “Incorrect. Try again!”.</p>
      <button class="btn" id="startBtn">Start</button>
    </div>
  </section>

  <!-- Game screen -->
  <section id="gameScreen" class="screen">
    <div class="card">
      <h1>Months - Type in Spanish</h1>
      <div class="layout">
        <div id="englishList" class="column"></div>
        <div id="inputList" class="column"></div>
      </div>
      <div class="toolbar">
        <button class="btn" id="restartBtn">Restart</button>
      </div>
    </div>
  </section>

  <div id="goodJob">GOOD JOB!</div>
  <canvas id="confetti"></canvas>

  <script>
    const EN = ["January","February","March","April","May","June","July","August","September","October","November","December"];
    const ES = ["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];

    const startBtn = document.getElementById('startBtn');
    const restartBtn = document.getElementById('restartBtn');
    const startScreen = document.getElementById('startScreen');
    const gameScreen  = document.getElementById('gameScreen');
    const englishList = document.getElementById('englishList');
    const inputList   = document.getElementById('inputList');
    const goodJobEl   = document.getElementById('goodJob');
    const confettiCv  = document.getElementById('confetti');
    const ctx         = confettiCv.getContext('2d');

    let matches = 0;
    let confettiRunning = false;
    let rafId = null;
    let pieces = [];

    startBtn.addEventListener('click', () => {
      startScreen.style.display = 'none';
      gameScreen.style.display  = 'block';
      initGame();
    });

    restartBtn.addEventListener('click', restartGame);

    function initGame(){
      stopConfetti();
      goodJobEl.style.display = 'none';
      matches = 0;
      englishList.innerHTML = '';
      inputList.innerHTML = '';

      EN.forEach((month, i) => {
        // Left: English month cell
        const enCell = document.createElement('div');
        enCell.className = 'en-cell';
        enCell.textContent = month;
        englishList.appendChild(enCell);

        // Right: input with inline error message
        const wrap = document.createElement('div');
        wrap.className = 'input-wrap';

        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'input-cell';
        input.placeholder = 'Write in Spanish';
        input.autocomplete = 'off';
        input.dataset.index = String(i);

        const err = document.createElement('div');
        err.className = 'error-msg';
        err.setAttribute('aria-live','polite');
        err.textContent = 'Incorrect. Try again!';

        // typing clears error style
        input.addEventListener('input', () => {
          input.classList.remove('incorrect');
          err.classList.remove('show');
          // If user re-typed exactly correct while editing, mark success instantly
          if (equalsNormalized(input.value, ES[i])) {
            markCorrect(input, i, err);
          }
        });

        // Validate on Enter
        input.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            validate(input, i, err);
          }
        });

        // Validate on blur
        input.addEventListener('blur', () => validate(input, i, err));

        wrap.appendChild(input);
        wrap.appendChild(err);
        inputList.appendChild(wrap);
      });
    }

    function validate(input, index, err){
      if (input.disabled) return; // already solved
      const value = input.value.trim();
      if (!value) { // empty -> no error message
        err.classList.remove('show');
        input.classList.remove('incorrect');
        return;
      }
      if (equalsNormalized(value, ES[index])) {
        markCorrect(input, index, err);
      } else {
        // show error in English
        input.classList.remove('correct');
        input.classList.add('incorrect');
        err.textContent = 'Incorrect. Try again!';
        err.classList.add('show');
      }
    }

    function markCorrect(input, index, err){
      if (!input.classList.contains('correct')) {
        input.value = ES[index]; // enforce proper capitalization
        input.classList.remove('incorrect');
        input.classList.add('correct');
        err.classList.remove('show');
        input.disabled = true;
        matches++;
        if (matches === 12) celebrate();
      }
    }

    // Accent- & case-insensitive compare
    function equalsNormalized(a, b){
      const na = normalize(a);
      const nb = normalize(b);
      return na === nb;
    }
    function normalize(s){
      return s
        .toLowerCase()
        .normalize('NFD').replace(/\p{Diacritic}/gu,'') // strip accents
        .replace(/\s+/g,' ') // collapse spaces
        .trim();
    }

    function celebrate(){
      goodJobEl.style.display = 'flex';
      startConfetti();
    }

    function restartGame(){
      stopConfetti();
      goodJobEl.style.display = 'none';
      initGame();
    }

    // -------- Confetti --------
    function startConfetti(){
      if (confettiRunning) return;
      confettiRunning = true;
      resizeCanvas();
      pieces = createPieces(320);
      animate();
      window.addEventListener('resize', resizeCanvas);
    }
    function stopConfetti(){
      confettiRunning = false;
      if (rafId) cancelAnimationFrame(rafId);
      ctx.clearRect(0,0,confettiCv.width, confettiCv.height);
      window.removeEventListener('resize', resizeCanvas);
    }
    function resizeCanvas(){
      confettiCv.width = window.innerWidth;
      confettiCv.height = window.innerHeight;
    }
    function createPieces(n){
      const arr = [];
      for (let i=0; i<n; i++){
        arr.push({
          x: Math.random()*confettiCv.width,
          y: -Math.random()*confettiCv.height,
          r: Math.random()*6+3,
          vy: Math.random()*2+1,
          vx: (Math.random()-0.5)*2,
          rot: Math.random()*360,
          vr: (Math.random()-0.5)*10,
          hue: Math.floor(Math.random()*360)
        });
      }
      return arr;
    }
    function animate(){
      if (!confettiRunning) return;
      ctx.clearRect(0,0,confettiCv.width, confettiCv.height);
      for (const p of pieces){
        p.x += p.vx; p.y += p.vy; p.rot += p.vr;
        if (p.y - p.r > confettiCv.height){ p.y = -10; p.x = Math.random()*confettiCv.width; }
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot * Math.PI/180);
        ctx.fillStyle = `hsl(${p.hue} 100% 50%)`;
        const w = p.r * 1.2, h = p.r * 0.6;
        ctx.fillRect(-w/2, -h/2, w, h);
        ctx.restore();
      }
      rafId = requestAnimationFrame(animate);
    }

    // Boot
    (function boot(){
      // keep start/game screens ready
    })();
  </script>
</body>
</html>

